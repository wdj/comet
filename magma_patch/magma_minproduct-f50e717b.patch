diff -aur magma_minproduct.cloned/magma_minproductblas/gemm_stencil.cuh magma_minproduct/magma_minproductblas/gemm_stencil.cuh
--- magma_minproduct.cloned/magma_minproductblas/gemm_stencil.cuh	2020-08-20 09:53:22.559295000 -0400
+++ magma_minproduct/magma_minproductblas/gemm_stencil.cuh	2020-08-20 10:26:37.442185000 -0400
@@ -346,7 +346,10 @@
                       #ifdef CONJ_B
                         fma(rA[m], conj(rB[n]), rC[n][m]);
                       #else
-                        fma(rA[m], rB[n], rC[n][m]);
+                        //---BEGIN MODIFIED GENOMICS_METRICS
+                        //fma(rA[m], rB[n], rC[n][m]);
+                        myfmin(rA[m], rB[n], rC[n][m]);
+                        //---END MODIFIED GENOMICS_METRICS
                       #endif
                     #endif
                 }
@@ -421,7 +424,10 @@
                   #ifdef CONJ_B
                     fma(rA[m], conj(rB[n]), rC[n][m]);
                   #else
-                    fma(rA[m], rB[n], rC[n][m]);
+                    //---BEGIN MODIFIED GENOMICS_METRICS
+                    //fma(rA[m], rB[n], rC[n][m]);
+                    myfmin(rA[m], rB[n], rC[n][m]);
+                    //---END MODIFIED GENOMICS_METRICS
                   #endif
                 #endif
             }
diff -aur magma_minproduct.cloned/magma_minproductblas/gemm_stencil_defs.h magma_minproduct/magma_minproductblas/gemm_stencil_defs.h
--- magma_minproduct.cloned/magma_minproductblas/gemm_stencil_defs.h	2020-08-20 09:53:22.563292000 -0400
+++ magma_minproduct/magma_minproductblas/gemm_stencil_defs.h	2020-08-20 10:23:04.129021000 -0400
@@ -99,12 +99,18 @@
     #define add(A, B)        magma_minproductCadd(A, B)
     #define mul(A, B)        magma_minproductCmul(A, B)
     #define fma(A, B, C) C = magma_minproductCfma(A, B, C)
+    //---BEGIN ADDED GENOMICS_METRICS
+    #define myfmin(A, B, C) C = magma_minproductCfma(A, B, C)
+    //---END ADDED GENOMICS_METRICS
     #define make_FloatingPoint(x, y) MAGMA_minproduct_Z_MAKE(x, y);
   #else
     #define conj(A)          magma_minproductConjf(A)
     #define add(A, B)        magma_minproductCaddf(A, B)
     #define mul(A, B)        magma_minproductCmulf(A, B)
     #define fma(A, B, C) C = magma_minproductCfmaf(A, B, C)
+    //---BEGIN ADDED GENOMICS_METRICS
+    #define myfmin(A, B, C) C = magma_minproductCfmaf(A, B, C)
+    //---END ADDED GENOMICS_METRICS
     #define make_FloatingPoint(x, y) MAGMA_minproduct_C_MAKE(x, y);
   #endif
 #else
@@ -112,6 +118,23 @@
     #define add(A, B)         (A+B)
     #define mul(A, B)         (A*B)
     #define fma(A, B, C) C += (A*B)
+//#define myfmin(A, B, C) fma(A, B, C)
+    //---BEGIN ADDED GENOMICS_METRICS
+    #ifdef DOUBLE
+      //#if (__CUDA_ARCH__ == 700)
+      //  #define myfmin(A, B, C) C += ((double)fminf((float)(A), (float)(B)))
+      //#else
+        #define myfmin(A, B, C) C += fmin((A), (B))
+      //#endif
+      //#define myfmin(A, B, C) C += fmin((A), (B))
+      //#define myfmin(A, B, C) C += ( (A) < (B) ? (A) : (B) )
+      //#define myfmin(A, B, C) C += fminf((A), (B))
+      //#define myfmin(A, B, C) C += ( ( (A) + (B) - fabs( (A) - (B) ) ) * .5 )
+    #else
+      #define myfmin(A, B, C) C += fminf((A), (B))
+      //#define myfmin(A, B, C) C += ( (A) < (B) ? (A) : (B) )
+    #endif
+    //---END ADDED GENOMICS_METRICS
     #define make_FloatingPoint(x, y) (x)
 #endif
 
